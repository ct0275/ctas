-- Generic I/O Error
-- 티베로버그로 예상됨. (NUMBER형을 별도로 CTAS후 업뎃함)
create table hrddb_dbo.DFT050TL_NUMBER as select BORD050_SEQ, BORD050_HITS, BORD050_NOTICE_LEVEL, BORD050_MAILTO_HITS from dbo.DFT050TL@ms_hrddb;
--drop table hrddb_dbo.DFT050TL;
create table hrddb_dbo.DFT050TL (
	BORD050_SEQ NUMBER,
	BORD050_USER_ID varchar(1000),
	BORD050_USER_NAME varchar(1000),
	BORD050_SUBJECT varchar(1000),
	BORD050_CONTENT CLOB,
	BORD050_GROUP varchar(4000),
	BORD050_ISRT_DT DATE,
	BORD050_HITS NUMBER,
	BORD050_LINK varchar(1000),
	BORD050_STATE varchar(1000),
	BORD050_CALL varchar(1000),
	BORD050_NAME varchar(1000),
	BORD050_ASSIGN varchar(1000),
	BORD050_IS_OPEN varchar(1000),
	BORD050_PASSWORD varchar(1000),
	BORD050_SUB_OPTION varchar(1000),
	BORD050_NOTICE_LEVEL NUMBER,
	BORD050_OPTION varchar(1000),
	BORD050_IS_MAIN varchar(1000),
	BORD050_IS_USE varchar(1000),
	BORD050_MAILTO_ID varchar(1000),
	BORD050_MAILTO_NAME varchar(1000),
	BORD050_MAILTO_HITS NUMBER
);
insert into hrddb_dbo.DFT050TL( BORD050_SEQ
,BORD050_USER_ID
,BORD050_USER_NAME
,BORD050_SUBJECT
,BORD050_CONTENT
,BORD050_GROUP
,BORD050_ISRT_DT
--,BORD050_HITS
,BORD050_LINK
,BORD050_STATE
,BORD050_CALL
,BORD050_NAME
,BORD050_ASSIGN
,BORD050_IS_OPEN
,BORD050_PASSWORD
,BORD050_SUB_OPTION
--,BORD050_NOTICE_LEVEL
,BORD050_OPTION
,BORD050_IS_MAIN
,BORD050_IS_USE
,BORD050_MAILTO_ID
,BORD050_MAILTO_NAME
--,BORD050_MAILTO_HITS
) select  BORD050_SEQ
,BORD050_USER_ID
,BORD050_USER_NAME
,BORD050_SUBJECT
,BORD050_CONTENT
,BORD050_GROUP
,BORD050_ISRT_DT
--,BORD050_HITS
,BORD050_LINK
,BORD050_STATE
,BORD050_CALL
,BORD050_NAME
,BORD050_ASSIGN
,BORD050_IS_OPEN
,BORD050_PASSWORD
,BORD050_SUB_OPTION
--,BORD050_NOTICE_LEVEL
,BORD050_OPTION
,BORD050_IS_MAIN
,BORD050_IS_USE
,BORD050_MAILTO_ID
,BORD050_MAILTO_NAME
--,BORD050_MAILTO_HITS
 from dbo.DFT050TL@ms_hrddb;
update hrddb_dbo.DFT050TL x
set
x.BORD050_HITS = (select y.BORD050_HITS from hrddb_dbo.DFT050TL_NUMBER y where y.BORD050_SEQ = x.BORD050_SEQ and rownum = 1),
x.BORD050_NOTICE_LEVEL = (select y.BORD050_NOTICE_LEVEL from hrddb_dbo.DFT050TL_NUMBER y where y.BORD050_SEQ = x.BORD050_SEQ and rownum = 1),
x.BORD050_MAILTO_HITS = (select y.BORD050_MAILTO_HITS from hrddb_dbo.DFT050TL_NUMBER y where y.BORD050_SEQ = x.BORD050_SEQ and rownum = 1);
commit;
drop table hrddb_dbo.DFT050TL_NUMBER;
